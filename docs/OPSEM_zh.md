# 运营数据采集指南

本文档用于指导**关卡与成长进度**的数据采集。
目标：**准确还原用户的游戏进度与核心体验数据**，帮助运营团队分析留存、难度与成长节奏。

---

## 1. 核心原则：只记“进度”，不记“资产”

运营分析最关心的是**用户玩到哪了**（进度），而不是用户包里有多少钱（资产）。

*   **✅ 进度数据（要采集）**：关卡号、最高分、星级、主城等级。*(特点：只增不减，代表成长)*
*   **❌ 资产数据（别采集）**：金币、钻石、体力、道具数量。*(特点：忽上忽下，代表消耗)*

| 正确示范 (Good) | 错误示范 (Bad) |
| :---: | :---: |
| ![Correct](good.png) | ![Wrong](bad.png) |
| **关注核心进度**<br>Level 1 (关卡)<br>74,175 (分数)<br>3星 (评价) | **不要采集资源**<br>金币 30<br>*(这是消费数据，不是进度)* |

---

## 2. 场景一：闯关/关卡结算
**事件名：onLevelFinished**

适用于：三消、塔防、解谜等**一关一关过**的游戏。

### 运营看这里：我们要采集什么？
![Level Finished](levelfinished.png)

结合上图，我们需要采集以下 4 个核心维度：

1.  **Level 1 (关卡ID)**：用户刚打通了哪一关？*(必填)*
2.  **Score 74,175 (分数)**：这关打得怎么样？分数高不高？
3.  **3 Stars (评级)**：拿了金牌还是铜牌？*(用于分析关卡难度)*
4.  **Duration (耗时)**：这关玩了多久？*(用于判断是否卡关)*

### 开发看这里：代码怎么写？
```javascript
await task.onLevelFinished({
    levelId: "1",      // 对应界面上的 Level 1
    score: 74175,      // 对应界面上的 Score
    rating: 3,         // 对应界面上的 3颗星
    duration: 45000    // 本局耗时 45秒
});
```

---

## 3. 场景二：单局/无尽模式结算
**事件名：onGamePlayEnded**

适用于：跳一跳、跑酷、飞机大战等**单局循环、不断挑战最高分**的游戏。

### 运营看这里：我们要采集什么？
![Game Play Ended](playend.jpeg)

1.  **Score 9999 (核心成绩)**：本次挑战的最终成绩（米数/分数/击杀数）。
2.  **Duration (耗时)**：这一局坚持了多久？*(衡量玩法粘性)*
3.  **Rating (结果)**：(可选) 胜利/失败，或 S/A/B 评价。

### 开发看这里：代码怎么写？
```javascript
await task.onGamePlayEnded({
    score: 9999,       // 对应界面上的 本次得分
    duration: 120000,  // 本局坚持了 120秒
    rating: 3          // 可选：3代表胜利/破纪录，1代表失败
});
```

---

## 4. 场景三：等级/身份成长
**事件名：onLevelUpgrade**

适用于：RPG升级、主城升级、段位晋升等**长线成长**内容。

### 运营看这里：
我们关注用户的**成长阶梯**。例如：用户是卡在 5 级流失的，还是 10 级？
*   **采集时机**：升级成功的瞬间。
*   **注意**：只记录升级（Up），不记录掉段（Down）。

### 开发看这里：
```javascript
await task.onLevelUpgrade({
    levelId: "5",           // 刚刚升到了 Lv.5
    name: "Novice Knight"   // 等级名称（可选）
});
```

---

## 5. 常见疑问 (Q&A)

**Q1：用户失败了要不要报 `onLevelFinished`？**
> **不需要。**
> 运营主要关注“通过率”和“通关时长”。失败数据过多会干扰通过率计算。失败建议通过单独的埋点统计，或者只在“单局模式”中记录。

**Q2：用户反复刷同一关，要不要报？**
> **要报。**
> 只要用户真实完成了通关行为，就应该记录。这对分析用户的活跃度和刷关习惯很有用。

**Q3：为什么不能报金币？**
> 金币是“货币”，不是“进度”。
> 如果把金币报在进度里，运营会误以为用户“升到了 30 金币级”，导致数据报表完全不可读。
